
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pyart.retrieve.kdp_proc.kdp_maesaka &#8212; Py-ART Documentation</title>
    <link rel="stylesheet" href="../../_static/scipy.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pyart.retrieve.kdp_proc.filter_psidp" href="pyart.retrieve.kdp_proc.filter_psidp.html" />
    <link rel="prev" title="pyart.retrieve.kdp_proc.kdp_vulpiani" href="pyart.retrieve.kdp_proc.kdp_vulpiani.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pyart.retrieve.kdp_proc.filter_psidp.html" title="pyart.retrieve.kdp_proc.filter_psidp"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pyart.retrieve.kdp_proc.kdp_vulpiani.html" title="pyart.retrieve.kdp_proc.kdp_vulpiani"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Py-ART Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Developer Reference Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../retrieve.html" accesskey="U">pyart.retrieve</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pyart-retrieve-kdp-proc-kdp-maesaka">
<h1>pyart.retrieve.kdp_proc.kdp_maesaka<a class="headerlink" href="#pyart-retrieve-kdp-proc-kdp-maesaka" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="pyart.retrieve.kdp_proc.kdp_maesaka">
<code class="descclassname">pyart.retrieve.kdp_proc.</code><code class="descname">kdp_maesaka</code><span class="sig-paren">(</span><em>radar</em>, <em>gatefilter=None</em>, <em>method='cg'</em>, <em>backscatter=None</em>, <em>Clpf=1.0</em>, <em>length_scale=None</em>, <em>first_guess=0.01</em>, <em>finite_order='low'</em>, <em>fill_value=None</em>, <em>proc=1</em>, <em>psidp_field=None</em>, <em>kdp_field=None</em>, <em>phidp_field=None</em>, <em>debug=False</em>, <em>verbose=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/ARM-DOE/pyart/blob/master/pyart/retrieve/kdp_proc.py#L1134"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyart.retrieve.kdp_proc.kdp_maesaka" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the specific differential phase (KDP) from corrected (e.g.,
unfolded) total differential phase data based on the variational method
outlined in Maesaka et al. (2012). This method assumes a monotonically
increasing propagation differential phase (PHIDP) with increasing range
from the radar, and therefore is limited to rainfall below the melting
layer and/or warm clouds at weather radar frequencies (e.g., S-, C-, and
X-band). This method currently only supports radar data with constant range
resolution.</p>
<p>Following the notation of Maesaka et al. (2012), the primary control
variable k is proportional to KDP,</p>
<blockquote>
<div><p>k**2 = 2 * KDP * dr</p>
</div></blockquote>
<p>which, because of the square, assumes that KDP always takes a positive
value.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>radar</strong> : Radar</p>
<blockquote>
<div><p>Radar containing differential phase field.</p>
</div></blockquote>
<p><strong>gatefilter</strong> : GateFilter</p>
<blockquote>
<div><p>A GateFilter indicating radar gates that should be excluded when
analysing differential phase measurements.</p>
</div></blockquote>
<p><strong>method</strong> : str, optional</p>
<blockquote>
<div><p>Type of scipy.optimize method to use when minimizing the cost
functional. The default method uses a nonlinear conjugate gradient
algorithm. In Maesaka et al. (2012) they use the Broyden-Fletcher-
Goldfarb-Shanno (BFGS) algorithm, however for large functional size
(e.g., 100K+ variables) this algorithm is considerably slower than a
conjugate gradient algorithm.</p>
</div></blockquote>
<p><strong>backscatter</strong> : optional</p>
<blockquote>
<div><p>Define the backscatter differential phase. If None, the backscatter
differential phase is set to zero for all range gates. Note that
backscatter differential phase can be parameterized using attentuation
corrected differential reflectivity.</p>
</div></blockquote>
<p><strong>Clpf</strong> : float, optional</p>
<blockquote>
<div><p>The low-pass filter (radial smoothness) constraint weight as in
equation (15) of Maesaka et al. (2012).</p>
</div></blockquote>
<p><strong>length_scale</strong> : float, optional</p>
<blockquote>
<div><p>Length scale in meters used to bring the dimension and magnitude of the
low-pass filter cost functional in line with the observation cost
functional. If None, the length scale is set to the range resolution.</p>
</div></blockquote>
<p><strong>first_guess</strong> : float, optional</p>
<blockquote>
<div><p>First guess for control variable k. Since k is proportional to the
square root of KDP, the first guess should be close to zero to signify
a KDP field close to 0 deg/km everywhere. However, the first guess
should not be exactly zero in order to avoid convergence criteria after
the first iteration. In fact it is recommended to use a value closer to
one than zero.</p>
</div></blockquote>
<p><strong>finite_order</strong> : ‘low’ or ‘high’, optional</p>
<blockquote>
<div><p>The finite difference accuracy to use when computing derivatives.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int, optional</p>
<blockquote>
<div><p>Maximum number of iterations to perform during cost functional
minimization. The maximum number of iterations are only performed if
convergence criteria are not met. For variational schemes such as this
one, it is generally not recommended to try and achieve convergence
criteria since the values of the cost functional and/or its gradient
norm are somewhat arbitrary.</p>
</div></blockquote>
<p><strong>fill_value</strong> : float, optional</p>
<blockquote>
<div><p>Value indicating missing or bad data in differential phase field.</p>
</div></blockquote>
<p><strong>proc</strong> : int, optional</p>
<blockquote>
<div><p>The number of parallel threads (CPUs) to use. Currently no
multiprocessing capability exists.</p>
</div></blockquote>
<p><strong>psidp_field</strong> : str, optional</p>
<blockquote>
<div><p>Total differential phase field. If None, the default field name must be
specified in the Py-ART configuration file.</p>
</div></blockquote>
<p><strong>kdp_field</strong> : str, optional</p>
<blockquote>
<div><p>Specific differential phase field. If None, the default field name must
be specified in the Py-ART configuration file.</p>
</div></blockquote>
<p><strong>phidp_field</strong> : str, optional</p>
<blockquote>
<div><p>Propagation differential phase field. If None, the default field name
must be specified in the Py-ART configuration file.</p>
</div></blockquote>
<p><strong>debug</strong> : bool, optional</p>
<blockquote>
<div><p>True to print debugging information, False to suppress.</p>
</div></blockquote>
<p><strong>verbose</strong> : bool, optional</p>
<blockquote>
<div><p>True to print relevant information, False to suppress.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>kdp_dict</strong> : dict</p>
<blockquote>
<div><p>Retrieved specific differential phase data and metadata.</p>
</div></blockquote>
<p><strong>phidpf_dict, phidpr_dict</strong> : dict</p>
<blockquote>
<div><p>Retrieved forward and reverse direction propagation differential phase
data and metadata.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">References</p>
<p>Maesaka, T., Iwanami, K. and Maki, M., 2012: “Non-negative KDP Estimation
by Monotone Increasing PHIDP Assumption below Melting Layer”. The Seventh
European Conference on Radar in Meteorology and Hydrology.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="pyart.retrieve.kdp_proc.kdp_vulpiani.html"
                        title="previous chapter">pyart.retrieve.kdp_proc.kdp_vulpiani</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pyart.retrieve.kdp_proc.filter_psidp.html"
                        title="next chapter">pyart.retrieve.kdp_proc.filter_psidp</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/dev_reference/generated/pyart.retrieve.kdp_proc.kdp_maesaka.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pyart.retrieve.kdp_proc.filter_psidp.html" title="pyart.retrieve.kdp_proc.filter_psidp"
             >next</a> |</li>
        <li class="right" >
          <a href="pyart.retrieve.kdp_proc.kdp_vulpiani.html" title="pyart.retrieve.kdp_proc.kdp_vulpiani"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Py-ART Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Developer Reference Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../retrieve.html" >pyart.retrieve</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013-2019, Py-ART developers.
      Last updated on Apr 24, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
  </body>
</html>